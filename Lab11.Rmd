---
title: "Lab 11"
author: "Adam Hayes, Erin Omyer, Richard Park, Jasmine Sanchez"
date: "4/3/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
###Ariel and Rachel Regexs
```{r}
Anames <- filter(babynames,str_detect(babynames$name,"A"),year == 1988,sex == "F")
Anames2 <- filter(babynames,str_detect(babynames$name,"A"),year==1990,sex=="F")

names <- inner_join(Anames,Anames2,by="name") %>% mutate(diff=prop.y-prop.x) %>% select(name,prop.x,prop.y,diff)

year1973 <- filter(babynames,str_detect(babynames$name,"Ra[ey]?ch.*l"),year == 1973, sex == "F") %>% count(wt=n) 
#8346

year1988 <- filter(babynames,str_detect(babynames$name,"Ra[ey]?ch.*l"),year == 1988, sex == "F") %>% count(wt=n) 
#19946

year1990 <- filter(babynames,str_detect(babynames$name,"Ra[ey]?ch.*l"),year == 1990,sex == "F") %>% count(wt=n) 
#20369

year2017 <- filter(babynames,str_detect(babynames$name,"Ra[ey]?ch.*l"),year == 2017,sex == "F") %>% count(wt=n) 

year1973_2 <- filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year == 1973, sex == "F") %>% count(wt=n) 
#52

year1988_2 <- filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year == 1988, sex == "F") %>% count(wt=n) 
#1617	

year1990_2 <- filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year == 1990,sex == "F") %>% count(wt=n) 
#5366

year2017_2 <- filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year == 2017,sex == "F") %>% count(wt=n) 

Arieldiff <- filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year==1990,sex=="F") %>% count(wt=prop) - filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year==1988,sex=="F") %>% count(wt=prop)

Rachel <- filter(babynames,str_detect(babynames$name,"Ra[ey]?ch.*l"),year%in%c(1973,1988,1990)) %>% filter(name!="Rachelann") %>% filter(name!="Rachelanne")

Racheldiff <- filter(Rachel,year==1990,sex=="F") %>% count(wt=prop) - filter(Rachel,year==1988,sex=="F") %>% count(wt=prop)

```
```{r echo = FALSE, results = 'asis'}
library(knitr)
kable(year1973, caption = "The number of females with the name 'Rachel' in 1973")
```
```{r echo = FALSE, results = 'asis'}
library(knitr)
kable(year1988, caption = "The number of females with the name 'Rachel' in 1988")
```
```{r echo = FALSE, results = 'asis'}
library(knitr)
kable(year1990, caption = "The number of females with the name 'Rachel' in 1990")
```
```{r echo = FALSE, results = 'asis'}
library(knitr)
kable(year2017, caption = "The number of females with the name 'Rachel' in 2017")
```
```{r echo = FALSE, results = 'asis'}
library(knitr)
kable(year1973_2, caption = "The number of females with the name 'Ariel' in 1973")
```
```{r echo = FALSE, results = 'asis'}
library(knitr)
kable(year1988_2, caption = "The number of females with the name 'Ariel' in 1988")
```
```{r echo = FALSE, results = 'asis'}
library(knitr)
kable(year1990_2, caption = "The number of females with the name 'Ariel' in 1990")
```
```{r echo = FALSE, results = 'asis'}
library(knitr)
kable(year2017_2, caption = "The number of females with the name 'Ariel' in 2017")
```
```{r echo = FALSE, results = 'asis'}
library(knitr)
kable(Arieldiff, caption = "The difference in proportion of the female Ariel baby names over time")
```
```{r echo = FALSE, results = 'asis'}
library(knitr)
kable(Racheldiff, caption = "The difference in proportion of the female Ariel baby names over time")
```
####Comments
Over the time between 1973 and 1990, the popularity of the name was overall more common than the name 'Ariel'. The name 'Ariel' spiked between the years 1989 and 1990 from 1,617 to 5,366 females with the name. The chance of the name 'Rachel' was more common than the name 'Ariel', due to the simplicity in the name 'Rachel'. In 2017, the name 'Rachel' has almost double number of females than the name 'Ariel'.

###The Little Mermaid Effect
```{r}
library(tidyverse)
library(babynames)

filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year == 1973, sex == "F") %>% count(wt=prop) 
#3.346e-05

filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year == 1988, sex == "F") %>% count(wt=prop) #0.000841196	

filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year == 1990,sex == "F") %>% count(wt=prop) #0.002612356

Arielnames <- filter(babynames, str_detect(babynames$name,"Ar[iy]+.l+[^a]?$")) %>%
  group_by(year) %>%
  summarize(proportionAriel = sum(prop))

Allnames <- filter(babynames, str_detect(babynames$name,"A")) %>% group_by(year) %>% summarize(proportionAlll = sum(prop))

ggplot(data = Arielnames) + geom_line(aes(x = year, y = proportionAriel), color = "green") + geom_vline(xintercept = 1989) + ggtitle("The popularity of the name 'Ariel' over time")

ggplot(data = Arielnames) + geom_line(aes(x = year, y = proportionAriel), color = "blue") + geom_vline(xintercept = 1989) + ggtitle("The popularity of the name 'Ariel' in 1988 and 1990") + coord_cartesian(xlim = c(1988,1990))

ggplot(data = Allnames) + geom_line(aes(x = year, y = proportionAlll), color = "red") + geom_vline(xintercept = 1989) + ggtitle("The popularity of all 'A' names over time") + coord_cartesian(xlim = c(2000,2017))
```
####The Change in proportion in female Ariel baby names
The popularity of the name 'Ariel' increased in popularity between 1988 and 1990. The movie was released in the 1989 between the year range where it increased drastically. In 1988, the proportion of popularity was higher than usual being 0.0008, but then jumped to 0.0026 in 1990 after the release of the movie. The percentile of change in Ariel names ends up being 1, which results to the 100th percentile. No other girl names had the a bigger difference in proportions than the name 'Ariel'. The proportion of names besides 'Ariel' were higher in comparison to babies with the name, as shown on the plots above. At the year 1989, the proportion of 'Ariel' names boomed to almost a proportion of 0.004, but then slowly declined after the year of the movie 'The little Mermaid' being released.Then, looking at the data of the exact year 1989, the proportion of the name 'Ariel' was on a rapid incline after the movie was released. In comparison to other names besides 'Ariel', the proportion trend remainds the same as the years go on, but a slight increase in the beginning of the early 2000s as the popularity of 'Ariel' was on a decline.

###Adam's Findings

```{r}
library(tidyverse)
library(babynames)

data <- babynames

names <- babynames %>%
  group_by(year)%>%
  summarise(total = sum(n))

ada <- babynames %>%
  filter(str_detect(name, "^Ada"))%>%
  group_by(year)%>%
  summarise(num_ada = sum(n))

ada2 <- babynames %>%
  filter(str_detect(name, "^Adam$"))%>%
  group_by(year)%>%
  summarise(num_adam = sum(n))

newdata <- ada %>%
  left_join(names, by = "year")%>%
  mutate(prop = num_ada / total)

newnewdata <- newdata %>%
  left_join(ada2, by = "year") %>%
  mutate(prop_adam = num_adam / total)

ggplot(data = newnewdata)+
  geom_line(mapping = aes(x = year, y = prop), color = "red")+
  geom_line(mapping = aes(x = year, y = prop_adam))+
  labs(title = "Prop of names starting with Ada(red) and babies named Adam(black) by year")
```

### Richard's Findings

```{r}
library(tidyverse)
library(babynames)

data <- babynames

NamesRIC <- babynames %>%
  filter(str_detect(name, "^Ric") == T)

NamesRIC

PropName <- babynames %>%
  group_by(year) %>%
  summarise(number = sum(n))

PropRIC <- babynames %>%
  group_by(year) %>%
  filter(str_detect(name, "^Ric") == T) %>%
  summarise(number_RIC = sum(n))

PropRIC2 <- babynames %>%
  filter(str_detect(name, "^Richard$"))%>%
  group_by(year)%>%
  summarise(number_RICHARD = sum(n))


Newnamedata <- PropRIC %>%
  left_join(PropName, by = "year") %>%
  mutate(prop = number_RIC / number)

Newnamesdata <- Newnamedata %>%
  left_join(PropRIC2, by = "year") %>%
  mutate(proportion_Richard = number_RICHARD / number)

ggplot(data = Newnamesdata)+
  geom_point(mapping = aes(x = year, y = prop), color = "Blue")+
  geom_point(mapping = aes(x = year, y = proportion_Richard),color = "Red")+
  labs(title = "The Proportion of names that start with Ric(in blue) and babies named Richard(in red) by each year")
```
####Comments
My name's popularity compared to when I was born (in 1999) has declined. As seen in the ggplot, the red dots are on a downward slope which indicates that there was a downward decline in popularity. Furthermore, my name is currently not as popular compared to other names that start with the same 3 letters because the blue dots (which indicate the proportion of all names that start with "Ric") is higher than the red dots which shows that there are a lot of other names that start with "Ric". If the blue dots and red dots were a lot closer together then my name would be extremely popular among babies whose names started with "Ric".

###Erin's Findings
```{r}
library(tidyverse)
library(babynames)

dataset <- babynames

selectName <- babynames %>%
  group_by(year) %>%
  summarise(total = sum(n))

ERI_names <- babynames %>%
  filter(str_detect(name, "^Eri")) %>%
  group_by(year) %>%
  summarise(num_ERI = sum(n))

ERIN_names <- babynames %>%
  filter(str_detect(name, "^Erin$")) %>%
  group_by(year) %>%
  summarise(num_ERIN = sum(n))

data2 <- ERI_names %>%
  left_join(selectName, by = "year") %>%
  mutate(proportion = num_ERI / total)

data3 <- data2 %>%
  left_join(ERIN_names, by = "year") %>%
  mutate(proportionERIN = num_ERIN / total)

ggplot(data = data3) +
  geom_line(mapping = aes(x = year, y = proportion), color = "pink") + 
  geom_line(mapping = aes(x = year, y = proportionERIN), color = "blue") + 
  labs(title = "Proportion of names starting with 'ERI'(pink) compared to the name 'ERIN'(blue) over time")
```

####Comments
In order to find the proportions of names that began with "ERI" or my full name "ERIN", I incorporated the join function to join the babynames dataset for the different manipulated names. As shown by the data, my name wasn't popular until the 1980s where names beginning with "Eri" and named "Erin" peaked. Then, around the time I was born the popularity was declining. The popularity of a name starting with "Eri" was higher than "Erin", because there are various manipulations of name that involve the same three letters, which causes the higher proportion in pink on the graph. 